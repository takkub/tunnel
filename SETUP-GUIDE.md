# ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£ Setup Tunnel (‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï)

## ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÉ‡∏´‡∏°‡πà ‚≠ê

‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå `setup-tunnel.js` ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡πâ:

### ‚úÖ ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ (‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤)
- ‡∏™‡∏£‡πâ‡∏≤‡∏á tunnel ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å JSON file ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å `.cloudflared`
- ‡∏≠‡∏≤‡∏à‡πÑ‡∏î‡πâ tunnel ID ‡πÄ‡∏Å‡πà‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
- CNAME ‡∏≠‡∏≤‡∏à‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏µ‡πà tunnel ID ‡πÄ‡∏Å‡πà‡∏≤

### ‚úÖ ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß)
1. **‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á `tunnel create` ‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå**
2. **‡∏î‡∏∂‡∏á Tunnel ID ‡∏à‡∏≤‡∏Å output ‡∏ó‡∏µ‡πà gen ‡∏°‡∏≤** (‡πÅ‡∏ö‡∏ö real-time)
3. **‡πÉ‡∏ä‡πâ Tunnel ID ‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á:**
   - ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå `{tunnelId}.json` ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
   - ‡∏™‡∏£‡πâ‡∏≤‡∏á `config.yml` ‡∏î‡πâ‡∏ß‡∏¢ tunnel ID ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
   - **‡∏™‡∏£‡πâ‡∏≤‡∏á DNS route: `{domain}` ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Tunnel**

## ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

```bash
npm run setup
```

‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°:
1. **Tunnel name** (‡πÄ‡∏ä‡πà‡∏ô app-tunnel, office-tunnel, tak)
2. **Domain** (‡πÄ‡∏ä‡πà‡∏ô app.sabuytube.xyz)
3. **Local port** (default: 3000)
4. **Folder name** (‡πÄ‡∏ä‡πà‡∏ô app, office, tak)

## ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå

```
[1/6] Creating Cloudflare Tunnel...
‚úì Tunnel ID: b8b6a8f8-e2fa-4c9b-9282-398e82b0a214
‚úì Tunnel created with ID: b8b6a8f8-e2fa-4c9b-9282-398e82b0a214

[2/6] Creating config folder...
‚úì Created: C:\Users\monch\WebstormProjects\tunnel\tunnels\tak

[3/6] Copying credentials...
‚úì Copied: b8b6a8f8-e2fa-4c9b-9282-398e82b0a214.json

[4/6] Copying cert.pem...
‚úì Copied: cert.pem

[5/6] Creating config.yml...
‚úì Created: config.yml
  Tunnel ID: b8b6a8f8-e2fa-4c9b-9282-398e82b0a214
  Domain: tak.sabuytube.xyz

[6/6] Setting up DNS...
Setting up DNS route for: tak.sabuytube.xyz
‚úì DNS route created
  Domain: tak.sabuytube.xyz
  Tunnel: tak

==================================================
‚úì Setup Complete!
==================================================

Tunnel Information:
  Name:      tak
  ID:        b8b6a8f8-e2fa-4c9b-9282-398e82b0a214
  Domain:    tak.sabuytube.xyz
  Local:     http://localhost:3000
```

## ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### 1. **Tunnel ID ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á 100%**
- ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å output ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á `tunnel create` ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
- ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏∂‡πà‡∏á‡∏û‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô `.cloudflared`
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÑ‡∏î‡πâ tunnel ID ‡πÄ‡∏Å‡πà‡∏≤

### 2. **CNAME ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á**
- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ tunnel ID ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á gen ‡∏°‡∏≤
- ‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Tunnel ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ö tunnel ‡πÄ‡∏Å‡πà‡∏≤

### 3. **Config ‡πÑ‡∏ü‡∏•‡πå‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á**
- `config.yml` ‡πÉ‡∏ä‡πâ tunnel ID ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
- `credentials-file` ‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏µ‡πà `{tunnelId}.json` ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- Docker compose ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô

### 4. **‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô**
- ‡πÅ‡∏™‡∏î‡∏á tunnel ID ‡∏´‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
- ‡πÅ‡∏™‡∏î‡∏á CNAME target ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á
- Summary ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô

## ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á

```
tunnels/
  tak/
    b8b6a8f8-e2fa-4c9b-9282-398e82b0a214.json   ‚Üê Credentials (‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö tunnel ID)
    cert.pem                                     ‚Üê Certificate
    config.yml                                   ‚Üê Config (‡πÉ‡∏ä‡πâ tunnel ID ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á)

docker-compose-cloudflare-tak.yml               ‚Üê Docker compose file
```

## ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö CNAME ‡∏ö‡∏ô Cloudflare

1. ‡πÄ‡∏Ç‡πâ‡∏≤ **Cloudflare Dashboard**
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **Domain** (‡πÄ‡∏ä‡πà‡∏ô sabuytube.xyz)
3. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **DNS** ‚Üí **Records**
4. ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô CNAME:
   - **Name:** tak (‡∏´‡∏£‡∏∑‡∏≠ subdomain ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏)
   - **Target:** Tunnel ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á
   - **Proxy status:** Proxied (üü† Orange Cloud)

## ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Tunnel

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å setup ‡πÄ‡∏™‡∏£‡πá‡∏à:

```bash
# ‡πÄ‡∏£‡∏¥‡πà‡∏° tunnel ‡∏î‡πâ‡∏ß‡∏¢ Docker
docker-compose -f docker-compose-cloudflare-tak.yml up -d

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
docker ps

# ‡∏î‡∏π logs
docker logs cloudflared-tunnel-tak -f
```

## ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (Technical)

1. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô `exec()` function ‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ö parameter `returnOutput`
2. ‡∏î‡∏∂‡∏á output ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á `tunnel create` ‡∏î‡πâ‡∏ß‡∏¢ `stdio: 'pipe'`
3. ‡πÉ‡∏ä‡πâ regex pattern ‡∏´‡∏≤ tunnel ID ‡∏à‡∏≤‡∏Å output:
   - `Created tunnel .+ with id ([a-f0-9-]{36})`
   - UUID format: `[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}`
4. ‡πÉ‡∏ä‡πâ tunnel ID ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å ‡πÜ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô
5. ‡∏™‡∏£‡πâ‡∏≤‡∏á DNS route ‡∏î‡πâ‡∏ß‡∏¢ tunnel ID ‡πÅ‡∏ó‡∏ô‡∏ä‡∏∑‡πà‡∏≠ tunnel

## Troubleshooting

### ‡∏ñ‡πâ‡∏≤ tunnel ID ‡∏î‡∏∂‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á output ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á `tunnel create` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ debug

### ‡∏ñ‡πâ‡∏≤ credential file ‡∏´‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠
‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏à‡∏∞‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå JSON ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÉ‡∏ô `.cloudflared` ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÅ‡∏ó‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï tunnel ID

### ‡∏ñ‡πâ‡∏≤ DNS route ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á:
```
Run: cloudflared tunnel route dns <tunnel-id> <domain>
```

---

‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ CNAME ‡∏ã‡πâ‡∏≥‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÉ‡∏ä‡πâ tunnel ID ‡∏ó‡∏µ‡πà gen ‡∏°‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á! üéâ

